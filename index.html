<!DOCTYPE html>
<html>
<head>
  <title>Decentralized Chat v3</title>
  <script src="https://cdn.jsdelivr.net/npm/gun@0.2025/gun.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gun/lib/webrtc.js"></script>
  <style>
    .status::before { content: 'ğŸŒ ' }
    .connected { color: #2ecc71; }
    .disconnected { color: #e74c3c; }
  </style>
</head>
<body>
  <div id="status" class="disconnected">Initializing network...</div>
  
  <script>
    // Modern relay configuration
    const gun = Gun({
      peers: [
        'https://relay.decentralizedweb.net/gun',
        'https://p2p-relay.glitch.me/gun',
        'https://gun-relay.2025.failover.xyz/gun'
      ],
      localStorage: true,
      radisk: false
    });

    // Enhanced connection handler
    let connectionTimeout;
    gun.on('hi', peer => {
      clearTimeout(connectionTimeout);
      document.getElementById('status').className = 'connected';
      document.getElementById('status').textContent = `Connected via ${new URL(peer.url).hostname}`;
    });

    gun.on('bye', () => {
      connectionTimeout = setTimeout(() => {
        document.getElementById('status').className = 'disconnected';
        document.getElementById('status').textContent = 'No active relays found';
      }, 5000);
    });
  </script>
</body>
</html>
